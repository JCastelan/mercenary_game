{{extend 'layout.html'}}
{{block head}}
<script src="{{=URL('static', 'js/vue.js')}}"></script>
<script>
	// Define your URLs here.
	var get_name_url = "{{=URL('api', 'get_name', user_signature=True)}}";
	var load_counter_url = "{{=URL('api', 'load_counter', user_signature=True)}}";
	var save_counter_url = "{{=URL('api', 'save_counter', user_signature=True)}}";
	var load_resources_url = "{{=URL('api', 'load_resources', user_signature=True)}}";
	var save_resources_url = "{{=URL('api', 'save_resources', user_signature=True)}}";
</script>
{{end}}

<div class="main_content">
	<div id="vue-div" style="display:none">
		<!-- <div v-if="logged_in"> -->
		{{if auth.user is not None:}}
			<div class="container">
				<div class="quarter">
					<a class="btn" id="b_res" v-on:click="show_view_panel_resources()">Resources</a>
					<a class="btn" id="b_party" v-on:click="show_view_panel_party()">Party</a>
					<a class="btn" id="b_village" v-on:click="show_view_panel_village()">Village</a>
					<div v-if="viewing_resources">
						Inventory:<br><br>
						<div v-for="obj in band[0].inventory">
							${obj.num} x ${obj.name}<br>
						</div>
						<br>
						______________________________
						<br><br>
						<div v-for="res in resources">
							${res[1]} x ${res[0]}<br>
						</div>
					</div>
					<div v-if="viewing_party" v-for="member in band">
						Name: ${member.name}<br>
						Max Health: ${member.max_health}<br>
						Health: ${member.health} <a class="btn" v-if="can_eat_food(member)" v-on:click="eat_food(member)">Eat fud</a><br>
						Damage: ${member.weapon.damage}<br>
						Weapon: ${member.weapon.name}
						<a class="btn" v-if="can_equip_weapon(member)" v-on:click="equip_weapon(member)">Equip weapon</a>
						<a class="btn" v-if="member.weapon.name != 'fists'" v-on:click="unequip_weapon(member)">Unequip</a>
						<br>
						Armor: ${member.armor.name}
						<a class="btn" v-if="can_equip_armor(member)" v-on:click="equip_armor(member)">Equip armor</a>
						<a class="btn" v-if="member.armor.name != 'nothing'" v-on:click="unequip_armor(member)">Unequip</a>
						______________________________
						<br><br>
						<div v-for="(group_hp, i) in fighter_group_health">
							<div v-if="num_fighters[i] != 0">
								Number of level ${i+1} fighters: ${num_fighters[i]}<br>
								Level ${i+1} fighters group HP: ${group_hp}<br>
								<a class="btn" v-on:click="send_to_village(i)">Send a boi to the village</a>
							</div>
							<br>
						</div>
					</div>
					<div v-if="viewing_village">
                        <a class="btn" v-on:click="send_villager_to_party()"><i class="fa fa-plus" aria-hidden="true"></i></a>
                        Available villagers: ${available_villagers}<br>
                        <div class="gather_wood ">
                            Wood Gatherer
                            <a class="btn" v-on:click="increment_wood_gatherer()"><i class="fa fa-plus" aria-hidden="true"></i></a>
                            ${wood_gatherer}
                            <a class="btn" v-on:click="decrement_wood_gatherer()"><i class="fa fa-minus" aria-hidden="true"></i></a>
                        </div>
					</div>
				</div>
				<div class="threequarters" id="grid">this is a grid boi</div>
			</div>
			<div id="popup-event" v-if="show_popup">
				<a class="left btn" v-on:click="closePopup()">(Esc) Close</a>
				<input style="width:500px" class="not_padded center" :disabled="true" v-model="popup_title"></input>
				<input style="width:594px" class="not_padded" :disabled="true" v-model="popup_desc"></input>
				<br><br>
				<div v-for="(button, i) in popup_buttons">
					<a v-if="button.num" class="btn option_buttons" v-on:click="button.onClick()">(${i+1}) ${button.name} x ${button.num}</a>
					<a v-if="!button.num" class="btn option_buttons" v-on:click="button.onClick()">(${i+1}) ${button.name}</a>
				</div>
				<br>
				<div v-if="in_battle">
					Your HP: ${get_band_health()}
				</div>
				<br>
				<div v-if="in_battle">
					Enemy HP: ${enemy_health}
				</div>
			</div>
			<script src="{{=URL('static', 'js/exploration.js')}}"></script>
			<script src="{{=URL('static', 'js/resource_management.js')}}"></script>
			<script src="{{=URL('static', 'js/button_stuff.js')}}"></script>
	
			<div class="container padded center">
				<div class="quarter">
					<h2>Click the button to increment the counter</h2>
					<a class="center btn large" v-on:click="clicked"><tt>Click Me</tt></a>
					<a class="center btn large" v-on:click="saveCounter"><tt>Save counter</tt></a>
					<a class="center btn large" v-on:click="saveResources"><tt>Save resources</tt></a>
				</div>
				<div class="threequarters">
					<h1 class="right" id="counter">${counter}</h1>
				</div>
			</div>
		{{else:}}
		<!-- </div>
		<div v-if="!logged_in"> -->
			<h1 class="main_title">Welcome!</h1>
			<p class="explanation">This game is about managing a mercenary band. Please log in to use it.</p>
			<div class="login_button">
				<a href="{{=URL('default', 'user')}}" class="btn">Login</a>
			</div>
		<!-- </div> -->
		{{pass}}
	</div>
</div>

<script src="{{=URL('static', 'js/default_index.js')}}"></script>